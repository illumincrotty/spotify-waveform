import{S as b,i as y,s as j,j as m,m as p,o as l,x as _,u as h,v as d,J as g,A as x,e as S,c as w,a as q,d as $,b as A,f as D,X as L}from"../../chunks/vendor-b1344eba.js";import{L as M}from"../../chunks/loader-60a167ad.js";import{P}from"../../chunks/page-9c40ea66.js";import{t as k}from"../../chunks/storeSession-e6d207ba.js";import{g as i}from"../../chunks/navigation-51f4a605.js";import{p as z}from"../../chunks/stores-efe9605b.js";import{v as C}from"../../chunks/authentication-a60c1d91.js";import{b as v}from"../../chunks/paths-28a87002.js";/* empty css                                                                */import"../../chunks/singletons-12a22614.js";function E(c){let t,a,e;return a=new M({}),{c(){t=S("div"),m(a.$$.fragment),this.h()},l(s){t=w(s,"DIV",{class:!0});var r=q(t);p(a.$$.fragment,r),r.forEach($),this.h()},h(){A(t,"class","center-i")},m(s,r){D(s,t,r),l(a,t,null),e=!0},i(s){e||(_(a.$$.fragment,s),e=!0)},o(s){h(a.$$.fragment,s),e=!1},d(s){s&&$(t),d(a)}}}function I(c){let t,a;return t=new P({props:{title:"Authenticating",$$slots:{default:[E]},$$scope:{ctx:c}}}),{c(){m(t.$$.fragment)},l(e){p(t.$$.fragment,e)},m(e,s){l(t,e,s),a=!0},p(e,[s]){const r={};s&8&&(r.$$scope={dirty:s,ctx:e}),t.$set(r)},i(e){a||(_(t.$$.fragment,e),a=!0)},o(e){h(t.$$.fragment,e),a=!1},d(e){d(t,e)}}}function J(c,t,a){let e,s;g(c,k,o=>a(0,e=o)),g(c,z,o=>a(1,s=o)),x(()=>{e&&i("data",{replaceState:!0}),r()});const r=async()=>{const o=s.query.get("code"),u=s.query.get("state");if(!o)return{status:302,redirect:`${v}/`};if(!u)return{status:302,redirect:`${v}/`};if(o&&u){const f=await C(o,u,fetch);if(f.ok){const n=await f.json();(n==null?void 0:n.access_token)||i(""),(n==null?void 0:n.refresh_token)||i(""),(n==null?void 0:n.expires_in)||i(""),L(k,e={access_token:n.access_token,refresh_token:n.refresh_token,expires_at:Date.now()+1e3*+n.expires_in},e),i("data",{replaceState:!0})}else i("")}};return[]}class R extends b{constructor(t){super();y(this,t,J,I,j,{})}}export{R as default};
