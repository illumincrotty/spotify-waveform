import{S as v,i as b,s as w,j as u,m,o as p,x as d,u as h,v as _,J as x,A as y,e as j,c as S,a as A,d as $,b as L,f as P}from"../../chunks/vendor-cdbb4087.js";import{L as D}from"../../chunks/loader-6cbed9a5.js";import{P as M}from"../../chunks/page-d5e70828.js";import{t as g}from"../../chunks/storeSession-2643e21d.js";import{g as r}from"../../chunks/navigation-51f4a605.js";import{v as q}from"../../chunks/authentication-a60c1d91.js";import{b as k}from"../../chunks/paths-28a87002.js";/* empty css                                                                */import"../../chunks/singletons-12a22614.js";function z(c){let t,n,e;return n=new D({}),{c(){t=j("div"),u(n.$$.fragment),this.h()},l(s){t=S(s,"DIV",{class:!0});var a=A(t);m(n.$$.fragment,a),a.forEach($),this.h()},h(){L(t,"class","center-i")},m(s,a){P(s,t,a),p(n,t,null),e=!0},i(s){e||(d(n.$$.fragment,s),e=!0)},o(s){h(n.$$.fragment,s),e=!1},d(s){s&&$(t),_(n)}}}function C(c){let t,n;return t=new M({props:{title:"Authenticating",$$slots:{default:[z]},$$scope:{ctx:c}}}),{c(){u(t.$$.fragment)},l(e){m(t.$$.fragment,e)},m(e,s){p(t,e,s),n=!0},p(e,[s]){const a={};s&4&&(a.$$scope={dirty:s,ctx:e}),t.$set(a)},i(e){n||(d(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){_(t,e)}}}function E(c,t,n){let e;x(c,g,a=>n(0,e=a)),y(()=>{e!=="empty"&&(console.log("already exists"),console.log(e)),s()});const s=async()=>{const a=new URLSearchParams(window.location.search),i=a.get("code"),l=a.get("state");if(!i)return{status:302,redirect:`${k}/`};if(!l)return{status:302,redirect:`${k}/`};if(i&&l){const f=await q(i,l,fetch);if(f.ok){const o=await f.json();(o==null?void 0:o.access_token)||r(""),(o==null?void 0:o.refresh_token)||r(""),(o==null?void 0:o.expires_in)||r(""),g.set({access_token:o.access_token,refresh_token:o.refresh_token,expires_at:Date.now()+1e3*+o.expires_in}),console.log("Good"),console.log(e),r("data",{replaceState:!0})}else r("")}r("")};return[]}class K extends v{constructor(t){super();b(this,t,E,C,w,{})}}export{K as default};
