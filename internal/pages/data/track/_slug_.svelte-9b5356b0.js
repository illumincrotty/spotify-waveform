import{S as x,i as B,s as I,k as v,f as w,d as m,L as N,M as S,a as A,b as i,W as C,P as J,v as P,w as z,x as E,p as _,n as y,A as L,J as T,u as U,m as G,o as H,a4 as K}from"../../../chunks/vendor-a1568714.js";import{P as O}from"../../../chunks/page-bb6f7289.js";import{t as Q}from"../../../chunks/storeSession-d1b3e66e.js";import{c as R}from"../../../chunks/api-fcd4453a.js";import"../../../chunks/button-4ee46cb2.js";function W(r,t,n){const e=r.slice();return e[2]=t[n],e[4]=n,e}function V(r){let t,n,e,a;return{c(){t=N("rect"),this.h()},l(l){t=S(l,"rect",{x:!0,y:!0,width:!0,height:!0,rx:!0}),A(t).forEach(m),this.h()},h(){i(t,"x",n=r[4]/g*($+d)),i(t,"y",e=u/2-u*r[2]/2),i(t,"width",$),i(t,"height",a=u*r[2]),i(t,"rx","2")},m(l,s){w(l,t,s)},p(l,s){s&1&&e!==(e=u/2-u*l[2]/2)&&i(t,"y",e),s&1&&a!==(a=u*l[2])&&i(t,"height",a)},d(l){l&&m(t)}}}function q(r){let t,n=r[4]%g==0&&V(r);return{c(){n&&n.c(),t=v()},l(e){n&&n.l(e),t=v()},m(e,a){n&&n.m(e,a),w(e,t,a)},p(e,a){e[4]%g==0&&n.p(e,a)},d(e){n&&n.d(e),e&&m(t)}}}function X(r){let t,n,e=r[0],a=[];for(let l=0;l<e.length;l+=1)a[l]=q(W(r,e,l));return{c(){t=N("svg");for(let l=0;l<a.length;l+=1)a[l].c();this.h()},l(l){t=S(l,"svg",{xmlns:!0,viewBox:!0,"fill-rule":!0,"clip-rule":!0,"stroke-linejoin":!0,"stroke-miterlimit":!0,"aria-label":!0});var s=A(t);for(let o=0;o<a.length;o+=1)a[o].l(s);s.forEach(m),this.h()},h(){i(t,"xmlns","http://www.w3.org/2000/svg"),i(t,"viewBox",n="0 0 "+Math.ceil(r[0].length/g*($+d)-d)+" "+u),i(t,"fill-rule","evenodd"),i(t,"clip-rule","evenodd"),i(t,"stroke-linejoin","round"),i(t,"stroke-miterlimit","2"),i(t,"aria-label",r[1])},m(l,s){w(l,t,s);for(let o=0;o<a.length;o+=1)a[o].m(t,null)},p(l,[s]){if(s&1){e=l[0];let o;for(o=0;o<e.length;o+=1){const p=W(l,e,o);a[o]?a[o].p(p,s):(a[o]=q(p),a[o].c(),a[o].m(t,null))}for(;o<a.length;o+=1)a[o].d(1);a.length=e.length}s&1&&n!==(n="0 0 "+Math.ceil(l[0].length/g*($+d)-d)+" "+u)&&i(t,"viewBox",n),s&2&&i(t,"aria-label",l[1])},i:C,o:C,d(l){l&&m(t),J(a,l)}}}const $=4,d=1,g=1,u=100;function Y(r,t,n){let{data:e=[]}=t,{label:a="Chart"}=t;return r.$$set=l=>{"data"in l&&n(0,e=l.data),"label"in l&&n(1,a=l.label)},[e,a]}class Z extends x{constructor(t){super();B(this,t,Y,X,I,{data:0,label:1})}}function F(r){let t,n;return t=new Z({props:{data:r[0]}}),{c(){P(t.$$.fragment)},l(e){z(t.$$.fragment,e)},m(e,a){E(t,e,a),n=!0},p(e,a){const l={};a&1&&(l.data=e[0]),t.$set(l)},i(e){n||(_(t.$$.fragment,e),n=!0)},o(e){y(t.$$.fragment,e),n=!1},d(e){L(t,e)}}}function ee(r){let t,n,e=r[0]&&F(r);return{c(){e&&e.c(),t=v()},l(a){e&&e.l(a),t=v()},m(a,l){e&&e.m(a,l),w(a,t,l),n=!0},p(a,l){a[0]?e?(e.p(a,l),l&1&&_(e,1)):(e=F(a),e.c(),_(e,1),e.m(t.parentNode,t)):e&&(G(),y(e,1,1,()=>{e=null}),H())},i(a){n||(_(e),n=!0)},o(a){y(e),n=!1},d(a){e&&e.d(a),a&&m(t)}}}function te(r){let t,n;return t=new O({props:{title:r[1],$$slots:{default:[ee]},$$scope:{ctx:r}}}),{c(){P(t.$$.fragment)},l(e){z(t.$$.fragment,e)},m(e,a){E(t,e,a),n=!0},p(e,[a]){const l={};a&2&&(l.title=e[1]),a&2049&&(l.$$scope={dirty:a,ctx:e}),t.$set(l)},i(e){n||(_(t.$$.fragment,e),n=!0)},o(e){y(t.$$.fragment,e),n=!1},d(e){L(t,e)}}}const ie=({params:r,fetch:t,session:n,stuff:e})=>({props:{trackID:r.slug}});function ae(r,t,n){let e;T(r,Q,f=>n(8,e=f));let{trackID:a=""}=t,l,s,o="Track Name";U(()=>{console.debug(`id: ${a}`),e!=="empty"&&p(e),K().then(()=>{})});const p=async f=>{l=R(f);const j=await l.track(a);n(1,o=`${j.name} by ${j.artists[0].name}`),l.track(a),l.audioFeatures(a),l.audioAnalysis(a);let k=await l.audioAnalysis(a);Math.min(...k.segments.map(c=>c.loudness_max));let h=k.segments.map(c=>({time:c.start,duration:c.duration,loud:1-Math.min(Math.max(c.loudness_max,-35),0)/-35}));n(0,s=h.map(c=>c.loud));const D=[];let b=0;console.log(`Duration: ${k.track.duration}`);for(let c=0;c<100;c++){const M=k.track.duration/100*c;for(console.log(M);h.length-1>b&&h[b+1].time<=M;)b+=1;D.push(h[b].loud)}n(0,s=D),console.log(h),console.log(D)};return r.$$set=f=>{"trackID"in f&&n(2,a=f.trackID)},[s,o,a]}class ce extends x{constructor(t){super();B(this,t,ae,te,I,{trackID:2})}}export{ce as default,ie as load};
